# Nexus-IaaS Quick Start Guide

Welcome to **Nexus-IaaS**! This guide will get you up and running in 10 minutes.

---

## üöÄ Prerequisites Checklist

Before starting, ensure you have:

- ‚úÖ **Linux Server** (Ubuntu 22.04 / Debian 12 recommended)
- ‚úÖ **Proxmox VE** installed and accessible (v7.0+)
- ‚úÖ **Root or sudo access** to your web server
- ‚úÖ **MySQL/MariaDB** installed
- ‚úÖ **PHP 8.2+** with required extensions
- ‚úÖ **Python 3.10+** installed
- ‚úÖ **Domain name** (optional but recommended)

---

## ‚ö° Quick Installation (5 Minutes)

### Option 1: Automated Script (Recommended)

```bash
# Clone the repository
cd /var/www
git clone https://github.com/yourusername/nexus-iaas.git
cd nexus-iaas

# Run installation script
chmod +x install.sh
sudo ./install.sh
```

The script will:
1. Install dependencies
2. Create database
3. Configure environment
4. Setup Python virtual environment
5. Install systemd service
6. Configure Apache/Nginx

### Option 2: Manual Installation

See [README.md](README.md#-installation) for detailed manual steps.

---

## üîß Essential Configuration

### 1. Edit `.env` File

```bash
nano .env
```

**Update these critical values:**

```ini
# Proxmox Connection
PROXMOX_HOST=192.168.1.100       # Your Proxmox IP
PROXMOX_USER=root@pam            # Proxmox user
PROXMOX_PASSWORD=YourPassword    # Proxmox password
PROXMOX_NODE=pve                 # Your node name

# Database (already set by install script)
DB_HOST=localhost
DB_NAME=nexus_iaas
DB_USER=nexus_user
DB_PASS=YourDatabasePassword

# Security (auto-generated by install script)
SESSION_SECRET=<long_random_string>
```

### 2. Test Python Bridge

```bash
cd /var/www/nexus-iaas/scripts
source venv/bin/activate

# Test Proxmox connection (replace VMID with existing VM)
python proxmox_bridge.py --action status --vmid 100

# Expected output: {"success": true, "vmid": 100, "status": "running", ...}
```

### 3. Start Worker Daemon

```bash
sudo systemctl start nexus-iaas.service
sudo systemctl status nexus-iaas.service

# Check logs
sudo tail -f /var/log/nexus-iaas/worker.log
```

---

## üéØ First Login

### 1. Access the Web Interface

Open your browser:
```
http://your-server-ip/login.php
# or
http://cloud.yourdomain.com/login.php
```

### 2. Login with Default Admin Credentials

```
Email:    admin@nexus-iaas.local
Password: Admin@123456
```

### 3. **IMPORTANT: Change Password Immediately!**

```
1. Click Settings (left sidebar)
2. Change Password section
3. Enter new secure password
4. Click "Update Password"
```

---

## üñ•Ô∏è Create Your First VM

### Step 1: Add IP Addresses to Pool

Login to MySQL:
```bash
mysql -u nexus_user -p nexus_iaas
```

```sql
INSERT INTO ip_pool (ip_address, gateway) VALUES
('192.168.100.10', '192.168.100.1'),
('192.168.100.11', '192.168.100.1'),
('192.168.100.12', '192.168.100.1');

SELECT * FROM ip_pool;
EXIT;
```

### Step 2: Add Balance to Admin Account

```sql
mysql -u nexus_user -p nexus_iaas
```

```sql
UPDATE users SET balance = 100.00 WHERE email = 'admin@nexus-iaas.local';
SELECT email, balance FROM users;
EXIT;
```

### Step 3: Create VM via Dashboard

1. Go to **Dashboard** ‚Üí Click **"Create VM"** button
2. Fill in VM details:
   - **Name**: `test-vm-01`
   - **OS Template**: `ubuntu-22.04`
   - **vCPU**: `2 Cores`
   - **RAM**: `2048 MB (2 GB)`
   - **Disk**: `40 GB`
3. Click **"Create Instance"**
4. Wait 30-60 seconds (watch status change from "pending" ‚Üí "running")

### Step 4: Monitor Progress

**Watch Worker Logs:**
```bash
sudo tail -f /var/log/nexus-iaas/worker.log
```

**Check Task Queue:**
```bash
mysql -u nexus_user -p nexus_iaas -e "SELECT * FROM task_queue ORDER BY created_at DESC LIMIT 5;"
```

---

## ‚úÖ Verification Checklist

Run these tests to ensure everything works:

### 1. Web Interface Accessible
```bash
curl -I http://localhost/login.php
# Expected: HTTP/1.1 200 OK
```

### 2. Database Connection
```bash
php -r "require '/var/www/nexus-iaas/config/Database.php'; \
        NexusIaaS\Config\Database::getInstance(); \
        echo 'Database connected!'.PHP_EOL;"
```

### 3. Worker Daemon Running
```bash
sudo systemctl is-active nexus-iaas.service
# Expected: active
```

### 4. Python Bridge Functional
```bash
cd /var/www/nexus-iaas/scripts
source venv/bin/activate
python proxmox_bridge.py --action status --vmid 100
# Expected: JSON output with success: true
```

### 5. API Endpoint Working
```bash
curl -X GET "http://localhost/api.php?action=ping" \
     -H "Cookie: NEXUS_SESSION=your_session_id"
# Expected: {"success":false,"message":"Authentication required"} (if not logged in)
```

---

## üêõ Troubleshooting

### Issue: "Database connection error"
```bash
# Check MySQL is running
sudo systemctl status mysql

# Verify credentials in .env
nano /var/www/nexus-iaas/.env

# Test connection
mysql -u nexus_user -p -e "USE nexus_iaas; SHOW TABLES;"
```

### Issue: "Worker daemon not starting"
```bash
# Check systemd status
sudo systemctl status nexus-iaas.service

# View detailed logs
sudo journalctl -u nexus-iaas.service -n 50

# Check file permissions
ls -la /var/www/nexus-iaas/scripts/worker.php
```

### Issue: "Python bridge failing"
```bash
# Test Python environment
cd /var/www/nexus-iaas/scripts
source venv/bin/activate
python --version  # Should be 3.10+

# Test proxmoxer installation
python -c "import proxmoxer; print('OK')"

# Check Proxmox connection
ping 192.168.1.100  # Your Proxmox IP
```

### Issue: "No IP addresses available"
```bash
# Check IP pool
mysql -u nexus_user -p nexus_iaas -e "SELECT * FROM ip_pool WHERE is_allocated = 0;"

# Add more IPs if needed
mysql -u nexus_user -p nexus_iaas <<< "INSERT INTO ip_pool (ip_address, gateway) VALUES ('192.168.100.20', '192.168.100.1');"
```

### Issue: "Insufficient balance"
```bash
# Add balance to user
mysql -u nexus_user -p nexus_iaas <<< "UPDATE users SET balance = 100.00 WHERE email = 'admin@nexus-iaas.local';"
```

---

## üîí Security Hardening (Production)

### 1. SSL/HTTPS Setup
```bash
sudo apt install certbot python3-certbot-apache
sudo certbot --apache -d cloud.yourdomain.com
```

### 2. Firewall Configuration
```bash
sudo ufw allow 22/tcp    # SSH
sudo ufw allow 80/tcp    # HTTP
sudo ufw allow 443/tcp   # HTTPS
sudo ufw enable
```

### 3. Change Default Credentials
- ‚úÖ Admin password (via Settings page)
- ‚úÖ MySQL root password
- ‚úÖ Proxmox password

### 4. Restrict File Permissions
```bash
chmod 600 /var/www/nexus-iaas/.env
chmod 755 /var/www/nexus-iaas
chown -R www-data:www-data /var/www/nexus-iaas
```

---

## üìö Next Steps

1. **Read the Full Documentation**: [README.md](README.md)
2. **Understand the Architecture**: [README.md#-architecture](README.md#-architecture)
3. **Explore the API**: [README.md#-api-documentation](README.md#-api-documentation)
4. **Setup Backups**: Schedule database dumps
5. **Monitor Logs**: Setup log rotation and monitoring
6. **Scale**: Add more Proxmox nodes (future feature)

---

## üÜò Need Help?

- **Documentation**: [README.md](README.md)
- **Issues**: [GitHub Issues](https://github.com/yourusername/nexus-iaas/issues)
- **Community**: [GitHub Discussions](https://github.com/yourusername/nexus-iaas/discussions)

---

## üéâ Success!

If you see your first VM running in the dashboard, congratulations! üéä

You now have a fully functional Infrastructure as a Service platform.

**Enjoy managing your cloud infrastructure with Nexus-IaaS!**

---

<div align="center">

**Copyright ¬© 2026 Krzysztof Siek | Licensed under MIT License**

‚≠ê Star us on GitHub if this helped you!

</div>
